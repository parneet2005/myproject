%一般モデル Sin6:
 %    f(x) = a1*sin(b1*x+c1) + a2*sin(b2*x+c2) + a3*sin(b3*x+c3) + a4*sin(b4*x+c4) + a5*sin(b5*x+c5) + a6*sin(b6*x+c6);
%係数 (95% の信頼限界):

%Regression polar
% a1 =        1.38;  %(1.117, 1.643)
% b1 =     0.00373;  %(-0.004227, 0.01169)
% c1 =      0.7139;  %(-0.3737, 1.801)
% a2 =      0.6258;  %(0.3335, 0.9181)
% b2 =     0.03058;  %(0.02118, 0.03998)
% c2 =     -0.8782;  %(-2.644, 0.8872)

%Non regression Polar
a1 =        8.26;%  (-942.4, 958.9)
b1 =     0.01214;%  (-0.4989, 0.5232)
c1 =     -0.6359;%  (-91.01, 89.74)
a2 =       6.884;%  (-985.5, 999.3)
b2 =     0.02017;%  (-0.5327, 0.573)
c2 =       1.092;%  (-95.56, 97.75)
a3 =       1.109;%  (-0.7691, 2.987)
b3 =     0.06781;%  (0.0366, 0.09902)
c3 =      -1.281;%  (-6.925, 4.363)
a4 =       1.743;%  (1.3, 2.185)
b4 =      0.1035;%  (0.09747, 0.1095)
c4 =      -1.499;%  (-2.64, -0.3582)
a5 =      0.3985;%  (0.06718, 0.7299)
b5 =      0.1711;%  (0.1619, 0.1802)
c5 =      -0.407;%  (-2.186, 1.372)
a6 =       3.606;%  (-111.3, 118.5)
b6 =     0.03184;%  (-0.1672, 0.2309)
c6 =       2.058;% (-33.74, 37.86)

%TOA Polar
% a1 =      0.8917;  %(-269.8, 271.6)
% b1 =    0.008235;  %(-0.5589, 0.5753)
% c1 =      0.1308;  %(-89.14, 89.4)
% a2 =      0.6125;  %(-270.1, 271.3)
% b2 =     0.01151;  %(-0.6449, 0.6679)
% c2 =        2.75; % (-102.6, 108.1)

ax=zeros(360,1);
ay=zeros(360,1);
for n=1:360
    ax(n,1) = n;
    ay(n,1) = a1*sin(b1*n+c1) + a2*sin(b2*n+c2) + a3*sin(b3*n+c3) + a4*sin(b4*n+c4) + a5*sin(b5*n+c5) + a6*sin(b6*n+c6);
end
hold on
polarplot(ax./360.*2*pi,ay)


% regression polar plot
% a1 =       1.265;  %(-92.52, 95.05)
% b1 =   8.277e-05;  %(-0.1453, 0.1455)
% c1 =       1.762;  %(-379.2, 382.7)
% a2 =      0.4327;  %(0.2363, 0.629)
% b2 =     0.03411;  %(0.02706, 0.04115)
% c2 =      -1.237;  %(-2.575, 0.1018)
% ax=zeros(360,1);
% ay=zeros(360,1);
% for n=1:360
%     ax(n,1) = n;
%     ay(n,1) = a1*sin(b1*n+c1) + a2*sin(b2*n+c2);% + a3*sin(b3*n+c3) + a4*sin(b4*n+c4) + a5*sin(b5*n+c5) + a6*sin(b6*n+c6);
% end
%polarplot(ax./360.*2*pi,ay)






% %regression polar plot for t21 input same side 0.1ns
% a1 =       1.049;  %(0.9072, 1.192)
% b1 =    0.002603;  %(-0.003033, 0.00824)
% c1 =      0.9828;  %(0.1531, 1.813)
% a2 =      0.6516;  %(0.5006, 0.8027)
% b2 =     0.03211;  %(0.02808, 0.03615)
% c2 =     -0.9739;  %(-1.723, -0.2247)
% ax=zeros(360,1);
% ay=zeros(360,1);
% for n=1:360
%     ax(n,1) = n;
%     ay(n,1) = a1*sin(b1*n+c1) + a2*sin(b2*n+c2);
% end
% polarplot(ax./360.*2*pi,ay)






%regression polar plot for t21 input with trig adjustment and boundaries
%set
% a1 =       8.691;  %(-2.118e+05, 2.118e+05)
% b1 =   0.0006854;  %(-17.44, 17.44)
% c1 =      -0.085;  %(-2170, 2170)
% a2 =       1.055;  %(-2167, 2169)
% b2 =    0.005715;  %(-3.419, 3.43)
% c2 =       2.242;  %(-588.1, 592.6)
% a3 =       0.119;  %(-1.761, 1.999)
% b3 =     0.03283;  %(-0.1057, 0.1714)
% c3 =       1.361;  %(-21.31, 24.03)
% 
% ax=zeros(360,1);
% ay=zeros(360,1);
% for n=1:360
%     ax(n,1) = n;
%     ay(n,1) =  a1*sin(b1*n+c1) + a2*sin(b2*n+c2) + a3*sin(b3*n+c3);
% end
% polarplot(ax./360.*2*pi,ay)







% p1 =   -2.86e-09;  %(-4.408e-09, -1.312e-09)
% p2 =   2.087e-06;  %(9.678e-07, 3.206e-06)
% p3 =  -0.0004904;  %(-0.0007567, -0.000224)
% p4 =     0.03944;  %(0.01666, 0.06222)
% p5 =      0.5255;  %(0.09689, 0.9542)
% 
% ax=zeros(360,1);
% ay=zeros(360,1);
% for n=1:360
%     ax(n,1) = n;
%     ay(n,1) =  p1*n^4 + p2*n^3 + p3*n^2 + p4*n + p5;
% end
% polarplot(ax./360.*2*pi,ay)
% 
% 
% a1 =       2.676;  %(-1.17, 6.522)
% b1 =    0.001692;  %(-0.01423, 0.01762)
% c1 =      0.8592;  %(-0.5031, 2.221)
% a2 =      0.7774;  %(-0.04556, 1.6)
% b2 =     0.06596;  %(0.04966, 0.08225)
% c2 =      -6.587;  %(-9.667, -3.507)
% a3 =       1.828;  %(0.9422, 2.714)
% b3 =     0.04146;  %(0.0349, 0.04802)
% c3 =      -2.739;  %(-4.042, -1.436)
% 
% ax=zeros(360,1);
% ay=zeros(360,1);
% for n=1:360
%     ax(n,1) = n;
%     ay(n,1) = a1*sin(b1*n+c1) + a2*sin(b2*n+c2) + a3*sin(b3*n+c3);
% end
% polarplot(ax./360.*2*pi,ay)


%PROPOSED MODEL WITH REGRESSION MODEL

   a1 =       9.044;  %(-475.1, 493.1)
   b1 =     0.01421;  %(-0.1149, 0.1433)
   c1 =     -0.9697;  %(-22.73, 20.79)
   a2 =       6.976;  %(-476.3, 490.2)
   b2 =     0.01885;  %(-0.1425, 0.1802)
   c2 =       1.385;  %(-26.03, 28.8)
   a3 =      0.8306;  %(-0.08577, 1.747)
   b3 =     0.05226;  %(0.03439, 0.07012)
   c3 =      -4.594;  %(-7.862, -1.326)

ax=zeros(360,1);
ay=zeros(360,1);
for n=1:360
    ax(n,1) = n;
    ay(n,1) = a1*sin(b1*n+c1) + a2*sin(b2*n+c2) + a3*sin(b3*n+c3);
end
polarplot(ax./360.*2*pi,ay)


%PROPOSED MODEL WITH REGRESSION MODEL AND RAYTRACING


a1 =       1.529;  %(-480.6, 483.6)
b1 =   0.0007633;  %(-0.3705, 0.3721)
c1 =       0.498;  %(-166.5, 167.5)
a2 =      0.2941;  %(-0.4835, 1.072)
b2 =     0.06882;  %(0.0295, 0.1081)
c2 =       1.962;  %(-4.531, 8.454)
a3 =      0.2123;  %(-2.114, 2.538)
b3 =     0.04437;  %(-0.05257, 0.1413)
c3 =      -4.538;  %(-28.12, 19.04)
a4 =      0.8128;  %(-5.318, 6.943)
b4 =     0.03542;  %(-0.0646, 0.1354)
c4 =      -1.339;  %(-15.94, 13.26)


ax=zeros(360,1);
ay=zeros(360,1);
for n=1:360
    ax(n,1) = n;
    ay(n,1) = a1*sin(b1*n+c1) + a2*sin(b2*n+c2) + a3*sin(b3*n+c3) + a4*sin(b4*n+c4);
end
polarplot(ax./360.*2*pi,ay)

